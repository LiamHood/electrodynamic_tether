function dstate = sbet_libration(t, state, epsilon, i, ta)
    theta = state(1);
    phi = state(2);
    dtheta = state(3);
    dphi = state(4);
    ddtheta = 2*(1+dtheta)*dphi*tan(phi) - 1.5*sin(2*theta)...
        -epsilon*(sin(i)*tan(phi)*(2*sin(ta)*cos(theta) - cos(ta)*sin(theta)) + cos(i));
    ddphi = -sin(phi)*cos(phi)*((1+dtheta)^2+3*cos(theta)^2)...
        +epsilon*sin(i)*(2*sin(ta)*sin())
end